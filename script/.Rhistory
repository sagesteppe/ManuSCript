install.packages('bookdown')
logR_dat <- read.csv('../data/PA_records_logistic_regression.csv')[,2:4] %>%
filter(occurrence == 0)
library(here)
library(tidyverse)
library(bookdown)
library(knitr)
library(kableExtra)
logR_dat <- read.csv('../data/PA_records_logistic_regression.csv')[,2:4] %>%
filter(occurrence == 0)
dat <- read.csv('/hdd/yun master/MEE_manuscript/data/evaluation_table.csv')[,2:3]
dat <- read.csv('../data/evaluation_table.csv')[,2:3]
data.frame(Metric  = dat[1:5,1],
Value   = dat[1:5,2],
Metric1 = dat[6:10,1],
Value1  = dat[6:10,2]
) %>%
knitr::kable(caption = "Logistic regression assessing accuracy of SDMs",
col.names = c('Metric', 'Value', 'Metric', 'Value'),
booktabs = T) #%>%
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
citation('usdm')
citation('sdm')
citation('SDM')
print(citation('iNEXT'), bibtex=TRUE)
install.packages('sdm')
install.packages('sdm')
citation('SDM')
citation('sdm')
install.packages('spdep')
cite('spdep')
citation('spdep')
print('spdep', bibtex=TRUE)
citation('spdep')
print(citation('spdep'), bibtex=TRUE)
print(citation('spdep'), bibtex=TRUE)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
read.csv('../data/Benkendorf_combos_fixed.csv')
read.csv('../data/Benkendorf_combos_fixed.csv') %>% filter(!str_detect(extract_id, ['a-z'])
read.csv('../data/Benkendorf_combos_fixed.csv') %>% filter(!str_detect(extract_id, ['a-z'])
read.csv('../data/Benkendorf_combos_fixed.csv') %>% filter(!str_detect(extract_id, ['a-z']))
read.csv('../data/Benkendorf_combos_fixed.csv') %>% filter(!str_detect(extract_id, ['a-z']))
read.csv('../data/Benkendorf_combos_fixed.csv') %>% filter(!str_detect(extract_id, '[a-z]'))
read.csv('../data/Benkendorf_combos_fixed.csv') |> filter(!str_detect(extract_id, '[a-z]'))
library(here)
library(tidyverse)
library(bookdown)
library(knitr)
suppressWarnings(library(kableExtra))
#print(citation('spdep'), bibtex=TRUE)
read.csv('../data/Benkendorf_combos_fixed.csv') |> filter(!str_detect(extract_id, '[a-z]'))
read.csv('../data/Benkendorf_combos_fixed.csv') |> filter(!str_detect(extract_id, '[aA-zZ]'))
read.csv('../data/Benkendorf_combos_fixed.csv') |>
filter(!str_detect(extract_id, '[aA-zZ]')) %>% n()
read.csv('../data/Benkendorf_combos_fixed.csv') |>
filter(!str_detect(extract_id, '[aA-zZ]')) %>% n(.)
read.csv('../data/Benkendorf_combos_fixed.csv') |>
filter(!str_detect(extract_id, '[aA-zZ]')) %>% nrow()
toString(toseq)
toseq <- read.csv('../data/Benkendorf_combos_fixed.csv') |>
filter(!str_detect(extract_id, '[aA-zZ]')) %>% nrow()
toString(toseq)
library(data.table)
setDTthreads(threads = 12)
library(tidyverse)
library(taxizedb)
library(scales)
source(here::here('functions.R'))
# import readouts from kraken2 files
files <- paste0("/home/reed/sequenceData/metagenome_class/", list.files(path = "/home/reed/sequenceData/metagenome_class",
pattern = '.txt'))
files <- files[grep('report', files, invert = T)]
mylist <- lapply(files, fread)
files <- gsub('.txt', '', files)
files <- gsub('.*\\/', '', files)
names(mylist) <- files
data <- rbindlist(mylist, idcol = T)
data <- rbindlist(mylist, idcol = T)
colnames(data) <- c('Sample', 'Classified', 'SeqID', 'TaxID', 'SeqLength', 'LCAMap')
colnames(data) <- c('Sample', 'Classified', 'SeqID', 'TaxID', 'SeqLength', 'LCAMap')
#data[, Sample := strsplit(data$Sample, '/')[[1]][6] ]
setkey(data, Sample)
head(data)
data %>% group_by(Sample) %>% count()
head(data)
data %>% group_by(Sample, Classified) %>% count()
data %>% group_by(Sample, Classified) %>% count() %>% write.csv(., '/hdd/yun master/MEE_manuscript/data/kraken_proc_reads.csv')
krak <- read.csv('../data/kraken_proc_reads.csv')
View(krak)
krak <- read.csv('../data/kraken_proc_reads.csv')
View(krak)
toString(filter(krak, Classified == 'C')
toString(filter(krak, Classified == 'C') %>% sum(n)
toString(filter(krak, Classified == 'C') %>% sum(n))
toString(filter(krak, Classified == 'C') %>% sum(n))
toString(filter(krak, Classified == 'C') %>% sum(n))
toString(filter(krak, Classified == 'C') %>% sum(n))
krak$Classified == 'c'
krak$Classified == 'C'
krak[krak$Classified == 'C',]
sum(krak[krak$Classified == 'C',]$n)
sum(krak[krak$Classified == 'C',]$n)
toString(sum(krak[krak$Classified == 'C',]$n))
gc()
files <- paste0("/home/reed/sequenceData/metagenome_class/", list.files(path = "/home/reed/sequenceData/metagenome_class",
pattern = '\\.bracken'))
mylist <- lapply(files, fread)
files <- gsub('.bracken', '', files)
files <- gsub('.*\\/', '', files)
names(mylist) <- files
bracken_data <- rbindlist(mylist, idcol = T)
View(bracken_data)
bracken_data %>% group_by(.id) %>% mutate(reads = sum(new_est_reads))
bracken_data %>% group_by(.id) %>% summarize(reads = sum(new_est_reads))
bracken_data %>% group_by(.id) %>% summarize(reads = sum(new_est_reads)) %>% write.csv(., '/hdd/yun master/MEE_manuscript/data/bracken_proc_reads.csv')
brack <- read.csv('../data/bracken_proc_reads.csv')
View(brack)
toString(sum(krak[krak$Classified == 'C',]$n))
krak <- read.csv('../data/kraken_proc_reads.csv')
toString(sum(krak[krak$Classified == 'C',]$n))
sum(brack$reads)
gc()
blast_classifications <- read.csv('/hdd/yun master/RMBL/corbicula loads/tally_blast_classifications.csv')[,2:6] %>%
mutate(Sample = as.numeric(Sample)) %>% rename(name = taxid)
View(blast_classifications)
View(blast_classifications)
blast_classifications %>% select(sample,Total_seqs) %>% distinct() %>% write.csv(., '/hdd/yun master/MEE_manuscript/data/blast_proc_reads.csv')
blast_classifications %>% select(Sample, Total_seqs) %>% distinct() %>% write.csv(., '/hdd/yun master/MEE_manuscript/data/blast_proc_reads.csv')
blast <- read.csv('../data/blast_proc_reads/csv')
blast <- read.csv('../data/blast_proc_reads.csv')
View(blast)
blast <- read.csv('../data/blast_proc_reads.csv')
View(blast)
View(bracken_data)
toString(sum(blast$Total_Seqs))
toString(sum(blast$Total_seqs))
gc()
